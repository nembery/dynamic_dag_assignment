name: get_dags

label: Load DAGs from Panorama

description: |
  Loads all configured DAGs from Panorama.

type: panos

labels:
  output_template: found_dags.j2

variables:

snippets:
  - name: capture_dags
    cmd: op
    cmd_str: <show><object><dynamic-address-group><all></all></dynamic-address-group></object></show>
    # parse_result defaults to True, so this is optional. However, some commands return invalid xml when parsed
    # in which case, you can pass the parse_result False option
    parse_result: True
    # capture the output of the 'capture_object' xpath query into a variable called 'cs_plugin'
    outputs:
      - name: dag_names
        capture_list: ./entry[@name='Mobile_User_Device_Group']/address-group/filter/text()
      - name: found_object
        capture_object: .